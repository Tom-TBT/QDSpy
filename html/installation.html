

<!doctype html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Getting ready &mdash; QDSpy 0.7 beta documentation</title>
    
    <link rel="stylesheet" href="_static/bizstyle.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.7 beta',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="_static/bizstyle.js"></script>
    <link rel="top" title="QDSpy 0.7 beta documentation" href="index.html" />
    <link rel="next" title="Configuration file" href="inifile.html" />
    <link rel="prev" title="How QDSpy works" href="how_QDSpy_works.html" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <!--[if lt IE 9]>
    <script type="text/javascript" src="_static/css3-mediaqueries.js"></script>
    <![endif]-->
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="inifile.html" title="Configuration file"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="how_QDSpy_works.html" title="How QDSpy works"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">QDSpy 0.7 beta documentation</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="index.html">
              <img class="logo" src="_static/QDSpy_Logo_smaller.jpg" alt="Logo"/>
            </a></p>
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Getting ready</a><ul>
<li><a class="reference internal" href="#installation">Installation</a></li>
<li><a class="reference internal" href="#running-the-gui-version-of-qdspy">Running the GUI version of QDSpy</a></li>
<li><a class="reference internal" href="#using-qdspy-with-the-shell">Using QDSpy with the shell</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="how_QDSpy_works.html"
                        title="previous chapter">How QDSpy works</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="inifile.html"
                        title="next chapter">Configuration file</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/installation.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="getting-ready">
<h1>Getting ready<a class="headerlink" href="#getting-ready" title="Permalink to this headline">¶</a></h1>
<div class="section" id="installation">
<h2>Installation<a class="headerlink" href="#installation" title="Permalink to this headline">¶</a></h2>
<ol class="arabic">
<li><p class="first">Install a current python distribution (<strong>64-bit, Python 3.5.x</strong>), e.g.
<a class="reference external" href="https://store.continuum.io/cshop/anaconda/">Anaconda</a>. The following
steps were tested with Anaconda3 - using a different distribution may
require the installation of additional packages.</p>
<p>You will need to start a windows shell can be started using <code class="docutils literal"><span class="pre">cmd.exe</span></code> or
<code class="docutils literal"><span class="pre">powershell.exe</span></code>. The latter is the better alternative, as it supports,
among other things, a Unix-like syntax.</p>
</li>
<li><p class="first">Anaconda may not come with PyOpenGL, therefore execute in the shell:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">pyopengl</span>
</pre></div>
</div>
</li>
<li><p class="first">Install the <a class="reference external" href="http://www.pyglet.org/">pyglet</a> extension by executing in the
shell:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">pyglet</span>
</pre></div>
</div>
</li>
<li><p class="first">Copy the content of the .zip file into a folder (e.g. <code class="docutils literal"><span class="pre">C:\User\QDSpy</span></code>),
keeping the internal folder substructure intact.</p>
</li>
<li><p class="first">To run QDSpy, it is important to add the path to the QDSpy main folder to
the <code class="docutils literal"><span class="pre">PYTHONPATH</span></code> environment variable. If this variable does not yet
exist, it needs to be created. There are several ways to do this; an easy
way is using Spyder, which comes with the Anaconda package:</p>
<ol class="loweralpha simple">
<li>run Spyder (note that the first start can take some time).</li>
<li>in the menu, select <code class="docutils literal"><span class="pre">Tools</span></code>, then <code class="docutils literal"><span class="pre">PYTHONPATH</span> <span class="pre">manager</span></code></li>
<li>add the path to the QDSpy folder and press the <code class="docutils literal"><span class="pre">synchronize</span></code> button.</li>
</ol>
<p>Note that open powershells need to be restarted to acknowledge this change.</p>
</li>
</ol>
<p>If you do not use any special hardware (e.g. digital I/O, a lightcrafter etc)
or do not need gamma correction, you can proceed to the section
<a class="reference internal" href="#running-the-gui-version-of-qdspy">Running the GUI version of QDSpy</a>. Otherwise continue with the following
steps.</p>
<ol class="arabic" start="6">
<li><p class="first">If you plan to use the LightCrafter 4500 not only as a displaying device
but also want to configure it via QDSpy (via USB), then you will need
the hidapi package.</p>
<p>For Python 3.4 and 3.5 (both 64 bit), pre-compiled libraries
(<code class="docutils literal"><span class="pre">hid.cp3x-win_amd64.pyd</span></code>) are provided in <code class="docutils literal"><span class="pre">...\QDSpy\Devices</span></code>. To test
if it works, run python in the main directory and try to import <code class="docutils literal"><span class="pre">hid</span></code>
from the <code class="docutils literal"><span class="pre">...\QDSpy\Devices</span></code> subfolder:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">PS</span> <span class="n">C</span><span class="p">:</span>\<span class="n">User</span>\<span class="n">QDSpy</span><span class="o">&gt;</span> <span class="n">python</span>
<span class="n">Python</span> <span class="mf">3.5</span><span class="o">.</span><span class="mi">1</span> <span class="o">|</span><span class="n">Anaconda</span> <span class="mf">4.0</span><span class="o">.</span><span class="mi">0</span> <span class="p">(</span><span class="mi">64</span><span class="o">-</span><span class="n">bit</span><span class="p">)</span><span class="o">|</span> <span class="p">(</span><span class="n">default</span><span class="p">,</span> <span class="n">Feb</span> <span class="mi">16</span> <span class="mi">2016</span><span class="p">,</span> <span class="mi">09</span><span class="p">:</span><span class="mi">49</span><span class="p">:</span><span class="mi">46</span><span class="p">)</span> <span class="p">[</span><span class="n">MSC</span> <span class="n">v</span><span class="o">.</span><span class="mi">1900</span> <span class="mi">64</span> <span class="n">bit</span> <span class="p">(</span><span class="n">AMD64</span><span class="p">)]</span> <span class="n">on</span> <span class="n">win32</span>
<span class="n">Type</span> <span class="s2">&quot;help&quot;</span><span class="p">,</span> <span class="s2">&quot;copyright&quot;</span><span class="p">,</span> <span class="s2">&quot;credits&quot;</span> <span class="ow">or</span> <span class="s2">&quot;license&quot;</span> <span class="k">for</span> <span class="n">more</span> <span class="n">information</span><span class="o">.</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">Devices.hid</span>
<span class="o">&gt;&gt;&gt;</span>
</pre></div>
</div>
<p>If no error occurs, your all set.</p>
<p>If this does not work, the <code class="docutils literal"><span class="pre">hidapi</span></code> package needs to be installed. The
installation of <code class="docutils literal"><span class="pre">hidapi</span></code> via pip generates an error unless the respective
Microsoft Visual C++ compiler/SDK package is installed. Note that Python 3.4.x
and 3.5.x require different versions of Microsoft Visual C++. Currently,
the following steps seem to work for Python 3.5.x:</p>
<ol class="loweralpha simple">
<li>Install Microsoft Visual Studio Community 2015 (or Microsoft Visual Studio
Express 2015); the free version is sufficient. Make sure you choose the
user-defined installation, where you can include Visual C++ including its
tools as well as Python Tools for Visual Studio.</li>
<li>Goto <a class="reference external" href="https://pypi.python.org/pypi/hidapi">hidapi</a>, choose the newest
package (currently <code class="docutils literal"><span class="pre">hidapi</span> <span class="pre">0.7.99.post14</span></code>) and follow the instructions
listed under <em>Build from source</em>. To this end, use the git shell that
comes with <a class="reference external" href="https://desktop.github.com/">GitHub for Windows</a>.</li>
</ol>
<p>Now try again importing <code class="docutils literal"><span class="pre">hid</span></code> as described above.</p>
</li>
</ol>
<div class="line-block">
<div class="line"><br /></div>
</div>
<ol class="arabic" start="7">
<li><p class="first">If you plan to use a digital I/O card from <a class="reference external" href="http://www.mccdaq.com">Measurement Computing</a>, you need to install their <a class="reference external" href="http://www.mccdaq.com/daq-software/universal-library.aspx">Universal Library</a>
(the 64-bit version). Note that you&#8217;ll need to reboot before the library is
available to QDSpy. Enable the support for digital I/O in the
<a class="reference internal" href="inifile.html"><span class="doc">Configuration file</span></a>:</p>
<div class="highlight-ini"><div class="highlight"><pre><span></span><span class="k">[Timing]</span>
<span class="na">bool_use_digitalio</span> <span class="o">=</span> <span class="s">True</span>
<span class="na">int_digitalio_board_num</span> <span class="o">=</span> <span class="s">0</span>
<span class="na">int_digitalio_device_num</span> <span class="o">=</span> <span class="s">1</span>
</pre></div>
</div>
</li>
</ol>
<div class="line-block">
<div class="line"><br /></div>
</div>
<ol class="arabic" start="8">
<li><p class="first">If you need gamma correction (currently Windows-only): Depending how strongly
the color presentation needs to be changed, you may have to define/change a
registry key that tells Windows normally to prevents too extreme color changes
by the user. For details on gamma correction, see <a class="reference external" href="https://msdn.microsoft.com/de-de/library/windows/desktop/jj635732%28v=vs.85%29.aspx#evolution_of_display_hardware">here</a>.</p>
<p>To deactivate Windows&#8217; safety measures, write the following text in a
file with the extension <code class="docutils literal"><span class="pre">.reg</span></code> and double-click it:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">HKEY_LOCAL_MACHINE</span>\<span class="n">SOFTWARE</span>\<span class="n">Microsoft</span>\<span class="n">Windows</span> <span class="n">NT</span>\<span class="n">CurrentVersion</span>\<span class="n">ICM</span><span class="p">]</span>
<span class="s2">&quot;GdiIcmGammaRange&quot;</span><span class="o">=</span><span class="n">dword</span><span class="p">:</span><span class="mi">00000100</span>
</pre></div>
</div>
<p>To reactivate Windows&#8217; safety measures:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">HKEY_LOCAL_MACHINE</span>\<span class="n">SOFTWARE</span>\<span class="n">Microsoft</span>\<span class="n">Windows</span> <span class="n">NT</span>\<span class="n">CurrentVersion</span>\<span class="n">ICM</span><span class="p">]</span>
<span class="s2">&quot;GdiIcmGammaRange&quot;</span><span class="o">=</span><span class="n">dword</span><span class="p">:</span><span class="mi">00000000</span>
</pre></div>
</div>
<p>You may have to reboot for this change to become active.</p>
<p>Note that QDSpy currently uses Windows&#8217; <code class="docutils literal"><span class="pre">SetDeviceGammaRamp</span></code> function
to change gamma. The advantage is that it is very simple to use, however,
a side effect is that all connected screens are affected.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">With the registry key set as described above, you can accidentally
turn all screens unreadable!!</p>
</div>
</li>
</ol>
</div>
<div class="section" id="running-the-gui-version-of-qdspy">
<h2>Running the GUI version of QDSpy<a class="headerlink" href="#running-the-gui-version-of-qdspy" title="Permalink to this headline">¶</a></h2>
<p>Open a windows shell (<code class="docutils literal"><span class="pre">powershell.exe</span></code>) and change to the QDSpy folder.
Run the GUI version of QDSpy:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Windows</span> <span class="n">PowerShell</span>
<span class="n">Copyright</span> <span class="p">(</span><span class="n">C</span><span class="p">)</span> <span class="mi">2014</span> <span class="n">Microsoft</span> <span class="n">Corporation</span><span class="o">.</span> <span class="n">Alle</span> <span class="n">Rechte</span> <span class="n">vorbehalten</span><span class="o">.</span>

<span class="n">PS</span> <span class="n">C</span><span class="p">:</span>\<span class="n">Users</span>\<span class="n">Thomas</span>\<span class="n">QDSpy3</span><span class="o">&gt;</span> <span class="n">python</span> <span class="n">QDSpy_GUI_main</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
<p>Alternatively, use the included batch file <code class="docutils literal"><span class="pre">QDSpy.bat</span></code> to start the GUI
version of QDSpy. For instance, create a link to this batch file on the
desktop; change the icon of this linke to <code class="docutils literal"><span class="pre">QDSpy.ico`</span></code>.</p>
<p>Using the batch file is equivalent to</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">PS</span> <span class="n">C</span><span class="p">:</span>\<span class="n">Users</span>\<span class="n">Thomas</span>\<span class="n">QDSpy3</span><span class="o">&gt;</span> <span class="n">python</span> <span class="n">QDSpy_GUI_main</span><span class="o">.</span><span class="n">py</span> <span class="o">--</span><span class="n">gui</span>
</pre></div>
</div>
<p>The optional command line parameter <code class="docutils literal"><span class="pre">--gui</span></code> directs all messages (except
for messages generated when scripts are compiled) exclusively to the history
window of the GUI. The parameter is ignored when starting stimulus files
directly from the shell.</p>
</div>
<div class="section" id="using-qdspy-with-the-shell">
<h2>Using QDSpy with the shell<a class="headerlink" href="#using-qdspy-with-the-shell" title="Permalink to this headline">¶</a></h2>
<p>Another way to compile and run stimulus scripts is by using the windows shell.</p>
<ol class="arabic">
<li><p class="first">Start a shell and change to the folder that contains the stimulus scripts:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Windows</span> <span class="n">PowerShell</span>
<span class="n">Copyright</span> <span class="p">(</span><span class="n">C</span><span class="p">)</span> <span class="mi">2014</span> <span class="n">Microsoft</span> <span class="n">Corporation</span><span class="o">.</span> <span class="n">Alle</span> <span class="n">Rechte</span> <span class="n">vorbehalten</span><span class="o">.</span>

<span class="n">PS</span> <span class="n">C</span><span class="p">:</span>\<span class="n">Users</span>\<span class="n">Thomas</span><span class="o">&gt;</span> <span class="n">e</span><span class="p">:</span>
<span class="n">PS</span> <span class="n">E</span><span class="p">:</span>\<span class="o">&gt;</span> <span class="n">cd</span> <span class="o">.</span>\<span class="n">user</span>\<span class="n">Dropbox</span>\<span class="n">QDSpy</span>\<span class="n">QDS_stimuli</span>
<span class="n">PS</span> <span class="n">E</span><span class="p">:</span>\<span class="n">user</span>\<span class="n">Dropbox</span>\<span class="n">QDSpy</span>\<span class="n">QDS_stimuli</span><span class="o">&gt;</span>
</pre></div>
</div>
</li>
<li><p class="first">Compile a script (for details on writing QDS stimulus scripts, see
<a class="reference internal" href="writing_scripts.html"><span class="doc">Writing QDSpy stimulus scripts</span></a>):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">PS</span> <span class="n">E</span><span class="p">:</span>\<span class="n">User</span>\<span class="n">Dropbox</span>\<span class="n">QDSpy</span>\<span class="n">Stimuli</span><span class="o">&gt;</span> <span class="n">python</span> <span class="o">.</span>\<span class="n">stimLCTest2</span><span class="o">.</span><span class="n">py</span>
     <span class="o">***</span> <span class="n">QDSpy</span> <span class="n">v0</span><span class="o">.</span><span class="mi">4</span> <span class="n">alpha</span> <span class="n">Compiler</span> <span class="o">-</span> <span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="mi">2013</span><span class="o">-</span><span class="mi">15</span> <span class="n">Thomas</span> <span class="n">Euler</span>
         <span class="n">Initializing</span> <span class="o">...</span>
         <span class="n">Defining</span> <span class="n">objects</span> <span class="o">...</span>
      <span class="n">ok</span> <span class="mi">150</span> <span class="nb">object</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="n">defined</span><span class="o">.</span>
      <span class="n">ok</span> <span class="mi">0</span> <span class="n">shader</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="n">defined</span><span class="o">.</span>
         <span class="n">Generating</span> <span class="n">scenes</span> <span class="o">...</span>
      <span class="n">ok</span> <span class="mi">245</span> <span class="n">scene</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="n">defined</span><span class="o">.</span>
      <span class="n">ok</span> <span class="n">Stimulus</span> <span class="s1">&#39;Test2&#39;</span> <span class="n">compiled</span> <span class="k">for</span> <span class="mf">60.0</span> <span class="n">Hz</span> <span class="n">refresh</span> <span class="p">(</span><span class="n">default</span><span class="p">)</span><span class="o">.</span>
      <span class="n">ok</span> <span class="n">Stimulus</span> <span class="s1">&#39;Test2&#39;</span> <span class="n">saved</span> <span class="n">to</span> <span class="s1">&#39;stimLCTest2.pickle&#39;</span>
      <span class="n">ok</span> <span class="o">...</span> <span class="n">done</span> <span class="ow">in</span> <span class="mf">1.204</span> <span class="n">s</span>
<span class="n">PS</span> <span class="n">E</span><span class="p">:</span>\<span class="n">User</span>\<span class="n">Dropbox</span>\<span class="n">QDSpy</span>\<span class="n">Stimuli</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>Some information about the script is shown, the script is compiled and
saved to disk as a .pickle file of the same name as the .py script file.</p>
</li>
<li><p class="first">To present the compiled stimulus, run the script again:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>PS E:\User\Dropbox\QDSpy\Stimuli&gt; python .\stimLCTest2.py
     *** QDSpy v0.4 alpha Compiler - (c) 2013-15 Thomas Euler
         Initializing ...
    INFO Script has not changed, running stimulus now ...
     *** QDSpy v0.4 alpha Presenter - (c) 2013-15 Thomas Euler
      ok Initializing ...
         ENABLED    : high process priority during presentation
         enabled    : automatic garbage collection
    INFO OpenGL     : v4.3.12618 Compatibility Profile Context 13.251.9001.1001
    INFO Renderer   : AMD Radeon HD 7800 Series by ATI Technologies Inc.
    INFO Timing     : vsync-based (Pyglet calls), DEFAULT
      ok Window mode, 800x600 pixels
         ENABLED    : forced fsync
      ok SwapIntervalEXT() reported success
      ok Stage center: 0,0 pixels, scale: 0.83,0.83 µm/pix, rotation: 0°, refresh: 60.0 Hz
         2 shader type(s) found
      ok Stimulus &#39;stimLCTest2.pickle&#39; loaded
         Name       : Test2
         Description: Test for Lightcrafter
         Frequency  : 60.0 Hz
      ok Stimulus &#39;Test2&#39; prepared
      ok Running...
 WARNING dt of frame #2 was 13.824 ms
 WARNING dt of frame #60 was 33.576 ms
 WARNING dt of frame #120 was 19.380 ms
 WARNING dt of frame #121 was 14.338 ms
      ok Done
      ok Program finished
    INFO 16.666 ms/frame (60.002 Hz), rendering: 1.033 ms (720 frames in total)
    INFO 16.689 +/- 0.669 ms/frame (over the last 719 frames) = 59.9 Hz
 WARNING 4 frames dropped (=0.556 %)
      ok ... done
PS E:\User\Dropbox\QDSpy\Stimuli&gt;
</pre></div>
</div>
<p>The script checks if the .pickle file is more recent that the .py file
(indicating that the .py file has not changed). If this is the case,
the stimulus is presented, acknowledging the settings in the folder&#8217;s
configuration file (<code class="docutils literal"><span class="pre">QDSpy.ini</span></code>, see <a class="reference internal" href="inifile.html"><span class="doc">Configuration file</span></a>).</p>
<p>Before displaying the stimulus, some information about the system is
shown. To abort the stimulus, press <code class="docutils literal"><span class="pre">Q</span></code>; note that (currently)
the focus has to be on the stimulus window for these keys to be active.</p>
</li>
</ol>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="inifile.html" title="Configuration file"
             >next</a> |</li>
        <li class="right" >
          <a href="how_QDSpy_works.html" title="How QDSpy works"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">QDSpy 0.7 beta documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2016 Thomas Euler, eulerlab @ CIN/University of Tübingen.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.4.3.
    </div>
  </body>
</html>